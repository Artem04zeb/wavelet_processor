# Исследование влияния предварительной обработки на эффективность алгоритмов сжатия изображений

**Автор:** Зебелян Артём Вячеславович  
**НИТУ «МИСиС», Москва, 2025**  
**Дисциплина:** Технологии программирования  
**Ссылка на проект:** [GitHub - wavelet_processor](https://github.com/Artem04zeb/wavelet_processor/)

---

## Введение

Цель работы — реализация алгоритма вейвлет-преобразования Хаара и анализ преобразований при разных параметрах.

### Задачи:
1. Анализ существующих реализаций и их ограничений
2. Разработка собственного алгоритма
3. Реализация на C++:
   - прямое и обратное преобразование;
   - настройка параметров сжатия
4. Комплексное тестирование:
   - метрики PSNR и SSIM;
   - визуальное сравнение

### Методология:
- Математическое моделирование
- Реализация на C++ с использованием OpenCV
- Эксперименты на датасетах *Kodak* и *CLIC 2025*
- Статистический анализ результатов

---

## Теоретические основы преобразований Хаара

Преобразование Хаара — простейший вид дискретного вейвлет-преобразования (DWT). Оно позволяет представить сигнал как комбинацию низкочастотных и высокочастотных компонентов.

### 2D-преобразование для изображений:

1. Преобразование строк (по горизонтали)
2. Преобразование столбцов (по вертикали)
3. Результат — разбиение на 4 области:
   - **LL** — приближение
   - **LH** — горизонтальные детали
   - **HL** — вертикальные детали
   - **HH** — диагональные детали

```

+------+------+
| LL   | LH   |
+------+------+
| HL   | HH   |
+------+------+

````

---

## Разработка

### Постановка задачи

Реализовать 2D-преобразование Хаара с возможностью восстановления изображения и настройки глубины и фильтрации коэффициентов.

### Используемые технологии:

- C++
- OpenCV
- CMake
- Visual Studio

---

## Реализация

### Прямое преобразование

```cpp
void cvHaarWavelet(cv::Mat& src, cv::Mat& dst, int NIter);
````

* Делит изображение на блоки 2×2
* Вычисляет LL, LH, HL, HH коэффициенты
* Многократно применяет преобразование к LL-области

### Обратное преобразование

```cpp
void apply_inv_Haar(cv::Mat& channel, cv::Mat& out_channel, int NIter, Shrinktype, float T);
```

* Восстанавливает пиксели по 4 коэффициентам
* Поддерживает фильтрацию:
  * NONE
  * HARD
  * SOFT
  * GARROT

---

## Метрики качества

### PSNR

```cpp
double getPSNR(const Mat& I1, const Mat& I2);
```

Вычисляет пиковое отношение сигнала к шуму. Чем выше — тем меньше искажение.

### SSIM

```cpp
double calculateSSIM(const Mat& i1, const Mat& i2);
```

Структурная метрика сходства. Значение ближе к 1 — изображения визуально похожи.

---

## Инструкция по запуску

### Тестовый режим

```
./wavelet_compressor.exe test <input_dir> <output.csv>
```

* Обрабатывает все изображения в папке
* Перебирает 36 комбинаций параметров
* Сохраняет метрики в CSV

### Рабочий режим

```
./wavelet_compressor.exe work <src> <dst> <NIter> <shrinktype> <shrinkage>
```

* Обрабатывает одно изображение и сохраняет его в указанной папке

---

## Проведение исследования

Тестирование проводилось с перебором:

* `NIter`: 2, 3, 4
* `Shrinktype`: NONE, HARD, SOFT, GARROT
* `Shrinkage`: 25.0, 50.0, 80.0

### Лучшие результаты:

* `Shrinktype = NONE`
* PSNR ≈ 55.2, SSIM ≈ 0.9988

### Худшие результаты:

* `Shrinktype = GARROT`, `NIter = 4`
* PSNR ≈ 20.3, SSIM ≈ 0.6430

---

## Заключение

* Оптимальные параметры: `NIter = 2, 3`, `Shrinktype = NONE`
* Агрессивное усечение (SOFT, GARROT) ухудшает качество
* Реализованный алгоритм позволяет гибко управлять компрессией

---

## Список литературы

1. Болотова Ж. Ю. *Вейвлет-преобразования в компьютерной графике* \[Электронный ресурс]. URL: [https://portal.tpu.ru/](https://portal.tpu.ru/)...
2. Ляховецкий В. *Преобразование Хаара для изображения* // Хабр. URL: [https://habr.com/](https://habr.com/)...
3. Полищук И. И. *Алгоритмы вейвлет-сжатия изображений* // Топ-науки. 2021. №5.
4. Гонсалес Р. С., Вудс Р. Е. *Цифровая обработка изображений*. М.: Техносфера, 2005.
5. Mallat S. *A Wavelet Tour of Signal Processing*. 3rd ed. Academic Press, 2008.
6. Strang G., Nguyen T. *Wavelets and Filter Banks*. Wellesley-Cambridge Press, 1996.
